<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>[Mod] ADMIN DM Project</name>
    <code>dm_project_admin</code>
    <version>2.3</version>
    <author>by DiMoss</author>
    <link>http://forum.opencart-russia.ru/members/dimoss.3919/</link>

    <!-- ======================================= //ADMIN-PANEL// ======================================= -->

    <!-- *** START LANGUAGE (Admin-panel) *** -->

    <!--  0.  RU-RU/EN-GB LANGUAGE (Admin-panel) -->

    <file path="admin/language/ru-ru/ru-ru.php">
        <operation>
            <search><![CDATA[
            $_['button_add']
            ]]></search>
            <add position="before" trim="true">
                <![CDATA[
$_['button_payment']                = 'К оплате';
                ]]>
            </add>
        </operation>
    </file>
    <file path="admin/language/en-gb/en-gb.php">
        <operation>
            <search><![CDATA[
            $_['button_add']
            ]]></search>
            <add position="before" trim="true">
                <![CDATA[
$_['button_payment']                = 'To pay';
                ]]>
            </add>
        </operation>
    </file>

    <!-- 1. CATEGORY LANGUAGE (Admin-panel) -->

    <file path="admin/language/ru-ru/catalog/category.php">
        <operation>
            <search><![CDATA[
            $_['text_default']
            ]]>
            </search>
            <add position="after"><![CDATA[
//mod
$_['text_by_default']        = 'По умолчанию';
$_['text_status_on']         = '<i class="fa fa-play"></i> вкл.';
$_['text_status_off']        = '<i class="fa fa-pause"></i> выкл.';
$_['text_disabled']          = 'Отключено';
$_['text_not_specified']     = 'Не указан';
$_['text_category_total']    = 'Всего категорий: ';
$_['text_category_template'] = 'Категория';
$_['text_product_template']  = 'Товар';
$_['text_products_template'] = 'Товары';
$_['text_variants_template'] = 'Вариации';
$_['text_attribute_groups']  = 'Разделить';
$_['text_attribute_display'] = 'Отображать';
$_['text_manufacturer']      = 'Производитель';

//Entry
$_['entry_template']          = 'Шаблон отображения';
$_['entry_template_products'] = 'Шаблон отображения товаров';
$_['entry_template_variations'] = 'Шаблон отображения вариаций';
$_['entry_thumb_size']        = 'Размер изображений товаров в категории';
$_['entry_width']             = 'Ширина';
$_['entry_height']            = 'Высота';
$_['entry_attribute_groups']  = 'Разделить вариации на группы по атрибуту';
$_['entry_attribute_display'] = 'Отображать у вариаций значение атрибута';
$_['entry_icon']              = 'Иконка категории';
$_['entry_icon_size']         = 'Размер иконки категории';
$_['entry_add_description']   = 'Доп.описание';
$_['entry_cut']               = 'Обрезать последнее слово в имени категории';
$_['entry_search_related']    = 'Искать родственные категории по имени';
$_['entry_search_regex']      = 'Регулярное выражение для preg_replace';
$_['entry_related']           = 'Дочерние товары';

//Tab
$_['tab_parent']             = 'Родительский товаров';
$_['tab_custom_template']    = 'Шаблон отображения категории';
$_['tab_related']            = 'Дочерние товары';

//Column
$_['column_parent']          = 'Родительский товар';
$_['column_templates']       = 'Шаблоны';
$_['column_attributes']      = 'Атрибуты';
$_['column_status']          = 'Статус';

//Buttons
$_['button_shop']            = 'Посмотреть на сайте';
//mod
            ]]>
            </add>
        </operation>
    </file>
    <file path="admin/language/en-gb/catalog/category.php">
        <operation>
            <search><![CDATA[
            $_['text_default']
            ]]>
            </search>
            <add position="after"><![CDATA[
//mod
$_['text_by_default']        = 'Default';
$_['text_status_on']         = '<i class="fa fa-play"></i> on';
$_['text_status_off']        = '<i class="fa fa-pause"></i> off';
$_['text_disabled']          = 'Disabled';
$_['text_not_specified']     = 'Not specified';
$_['text_category_total']    = 'Total categories: ';
$_['text_category_template'] = 'Category';
$_['text_product_template']  = 'Product';
$_['text_products_template'] = 'Products';
$_['text_variants_template'] = 'Variation';
$_['text_attribute_groups']  = 'Split';
$_['text_attribute_display'] = 'Display';
$_['text_manufacturer']      = 'Manufacturer';

//Entry
$_['entry_template']          = 'Template';
$_['entry_template_products'] = 'Template products';
$_['entry_template_variations'] = 'Template variation';
$_['entry_thumb_size']        = 'Images size in category';
$_['entry_width']             = 'Width';
$_['entry_height']            = 'Height';
$_['entry_attribute_groups']  = 'Divide variation into groups by attribute';
$_['entry_attribute_display'] = 'Display variation of the attribute value';
$_['entry_icon']              = 'Icon';
$_['entry_icon_size']         = 'Icons size';
$_['entry_add_description']   = 'Additional description';
$_['entry_cut']               = 'Сut category name';
$_['entry_search_related']    = 'Search related categories by name';
$_['entry_search_regex']      = 'Regular expression for preg_replace';
$_['entry_related']           = 'Subsidiaries';

//Tab
$_['tab_parent']             = 'Parent product';
$_['tab_custom_template']    = 'Custom template';
$_['tab_related']            = 'Subsidiaries';

//Column
$_['column_parent']          = 'Parent product';
$_['column_templates']       = 'Templates';
$_['column_attributes']      = 'Attributes';
$_['column_status']          = 'Status';

//Buttons
$_['button_shop']            = 'View on the site';
//mod
            ]]>
            </add>
        </operation>
    </file>

    <!-- 2. PRODUCT LANGUAGE (Admin-panel) -->

    <file path="admin/language/ru-ru/catalog/product.php">
        <operation>
            <search><![CDATA[
            $_['entry_recurring']
            ]]></search>
            <add position="after"><![CDATA[
//mod
$_['entry_main_category']    = 'Главная категория';
$_['entry_thumb_size']       = 'Размер большого изображения товара';
$_['entry_logged']           = 'Для зарег-х';

$_['text_create_parent_product']  = 'Новая категория с товаром';

$_['column_sku']             = 'Артикул';
$_['column_seo_url']         = 'SEO-url';
$_['column_variant']         = 'Вариация';
$_['column_tag']             = 'Теги';
$_['column_manufacturer']    = 'Производитель';

$_['text_product_filter']    = 'Фильтр товаров';
//mod
            ]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/catalog/product.php">
        <operation>
            <search><![CDATA[
            $_['entry_recurring']
            ]]></search>
            <add position="after"><![CDATA[
//mod
$_['entry_main_category']    = 'Main category';
$_['entry_thumb_size']       = 'Product image size';
$_['entry_logged']           = 'For Logged';

$_['text_create_parent_product']  = 'New category with products';

$_['column_sku']             = 'Sku';
$_['column_seo_url']         = 'SEO-url';
$_['column_variant']         = 'Variation';
$_['column_tag']             = 'Tags';
$_['column_manufacturer']    = 'Manufacturer';

$_['text_product_filter']    = 'Product\'s filter';
//mod
            ]]></add>
        </operation>
    </file>

    <!-- 3. SETTING LANGUAGE (Admin-panel) -->

    <file path="admin/language/ru-ru/setting/setting.php">
        <operation>
            <search><![CDATA[
            $_['entry_logo']
            ]]></search>
            <add position="after" trim="true"><![CDATA[
$_['entry_logo_footer']            = 'Логотип подвала';
            ]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/setting/setting.php">
        <operation>
            <search><![CDATA[
            $_['entry_logo']
            ]]></search>
            <add position="after" trim="true"><![CDATA[
$_['entry_logo_footer']            = 'Store Logo Footer';
            ]]></add>
        </operation>
    </file>

    <!--  5. MANUFACTURER LANGUAGE (Admin-panel) -->

    <file path="admin/language/ru-ru/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[
            $_['entry_type']
            ]]>
            </search>
            <add position="after"><![CDATA[
//modd
$_['entry_manufacturer_display'] = 'Шаблон отображения';
$_['entry_thumb_width']          = 'Ширина изображений товаров';
$_['entry_thumb_height']         = 'Высота изображений товаров';

//Text
$_['text_by_default']        = 'По умолчанию';
//mod
            ]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[
            $_['entry_type']
            ]]>
            </search>
            <add position="after"><![CDATA[
//mod
$_['entry_manufacturer_display'] = 'Template';
$_['entry_thumb_width']          = 'Image width';
$_['entry_thumb_height']         = 'Image height';

//Text
$_['text_by_default']        = 'Default';
//mod
            ]]></add>
        </operation>
    </file>

    <!--  5. FEATURED MODULE LANGUAGE (Admin-panel) -->

    <file path="admin/language/ru-ru/extension/module/featured.php">
        <operation>
            <search><![CDATA[
            $_['text_edit']
            ]]></search>
            <add position="after"><![CDATA[
//mod
$_['text_by_default']  = 'По умолчанию';

$_['entry_heading']    = 'Название модуля является заголовком';
$_['entry_category']   = 'Отображать товары из категории';
$_['entry_display']    = 'Шаблон отображения товаров';
//mod
            ]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/extension/module/featured.php">
        <operation>
            <search><![CDATA[
            $_['text_edit']
            ]]></search>
            <add position="after"><![CDATA[
//mod
$_['text_by_default']  = 'Default';

$_['entry_heading']    = 'Module name is the title';
$_['entry_category']   = 'Show products from category';
$_['entry_display']    = 'Product display template';
//mod
            ]]></add>
        </operation>
    </file>

    <!--  6.  INFORMATION LANGUAGE (Admin-panel) -->

    <file path="admin/language/ru-ru/catalog/information.php">
        <operation error="skip">
            <search><![CDATA[
            Отображить снизу
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            Отобразить снизу
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $_['entry_layout']
            ]]></search>
            <add position="after"><![CDATA[
//information top mod
$_['entry_bottom_help']   = 'Отобразить снизу в разделе Помощь';
$_['entry_top']           = 'Отобразить сверху';
$_['entry_product']       = 'Отобразить в товарах';

$_['help_bottom_help']    = 'Показывать в нижней части сайта (футер, подвал) в разделе Помощь';
$_['help_top']            = 'Показывать в верхней части сайта (хэдэр, шапка)';
$_['help_product']        = 'Закладки в карточке товара';
//information top mod
            ]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/catalog/information.php">
        <operation>
            <search><![CDATA[
            $_['entry_layout']
            ]]></search>
            <add position="after"><![CDATA[
//information top mod
$_['entry_bottom_help']   = 'Bottom - Help';
$_['entry_top']           = 'Top';
$_['entry_product']       = 'Show into product card';

$_['help_bottom_help']    = 'Display in the bottom footer - Help';
$_['help_top']            = 'Display in the top header';
$_['help_product']        = 'Nav-tabs into product card';
//information top mod
            ]]></add>
        </operation>
    </file>

    <!--  7.  DESIGN LANGUAGE (Admin-panel) -->

    <file path="admin/language/ru-ru/design/layout.php">
        <operation>
            <search><![CDATA[
            $_['text_content_top']
            ]]></search>
            <add position="after"><![CDATA[
$_['text_content_middle'] = 'Центр страницы';
            ]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/design/layout.php">
        <operation>
            <search><![CDATA[
            $_['text_content_top']    = 'Content Top';
            ]]></search>
            <add position="after"><![CDATA[
$_['text_content_middle'] = 'Content Center';
            ]]></add>
        </operation>
    </file>

    <!-- *** //END LANGUAGE (Admin-panel)// *** -->



    <!-- *** START MODEL (Admin-panel) *** -->

    <!-- 1. CATEGORY MODEL (Admin-panel) -->

    <file path="admin/model/catalog/category.php">
        <operation>
            <search><![CDATA[
            if (isset($data['image'])) {
            ]]></search>
            <add position="before"><![CDATA[
        //mod
		if (isset($data['attribute_groups'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET attribute_groups = '" . (int)$data['attribute_groups'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['attribute_display'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET attribute_display = '" . (int)$data['attribute_display'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['manufacturer_id'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET manufacturer_id = '" . (int)$data['manufacturer_id'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['category_display'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET category_display = '" . $data['category_display'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['products_display'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET products_display = '" . $data['products_display'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['product_display'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET product_display = '" . $data['product_display'] . "' WHERE category_id = '" . (int)$category_id . "'");

		    $query = $this->db->query("SELECT product_id FROM " . DB_PREFIX . "product_to_category WHERE category_id = '" . (int)$category_id . "'");

		    $product_variant_value = $data['product_display'] ? '1' : '0';

		    foreach ($query->rows as $result) {
		        $this->db->query("UPDATE " . DB_PREFIX . "product SET variation = '" . (int)$product_variant_value . "' WHERE product_id = '" . (int)$result['product_id'] . "'");
		    }
		}

		if (isset($data['product_related'])) {
		    foreach ($data['product_related'] as $product_id) {
                $this->db->query("DELETE FROM " . DB_PREFIX . "product_to_category WHERE product_id = '" . (int)$product_id . "'");
                $this->db->query("INSERT INTO " . DB_PREFIX . "product_to_category SET product_id = '" . (int)$product_id . "', category_id = '" . (int)$category_id . "', main_category = '1'");
                $this->db->query("UPDATE " . DB_PREFIX . "product SET variation = '1', status = '1' WHERE product_id = '" . (int)$product_id . "'");
            }
        }

		if (isset($data['variations_display'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET variations_display = '" . $data['variations_display'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['thumb_width']) && isset($data['thumb_height'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET thumb_width = '" . (int)$data['thumb_width'] . "', thumb_height = '" . (int)$data['thumb_height'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['icon'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET icon = '" . $this->db->escape($data['icon']) . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['icon_width'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET icon_width = '" . (int)$data['icon_width'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['icon_height'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET icon_height = '" . (int)$data['icon_height'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

	    if (isset($data['search_related'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET search_related = '" . (int)$data['search_related'] . "' WHERE category_id = '" . (int)$category_id . "'");
		}

		if (isset($data['search_regex'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "category SET search_regex = '" . $this->db->escape($data['search_regex']) . "' WHERE category_id = '" . (int)$category_id . "'");
		}
		//mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $this->db->query("INSERT INTO " . DB_PREFIX . "category_description SET category_id = '" . (int)$category_id . "', language_id = '" . (int)$language_id . "', name = '" . $this->db->escape($value['name']) . "', description = '" . $this->db->escape($value['description']) . "', meta_title = '" . $this->db->escape($value['meta_title']) . "', meta_description = '" . $this->db->escape($value['meta_description']) . "', meta_keyword = '" . $this->db->escape($value['meta_keyword']) . "'");
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            $this->db->query("INSERT INTO " . DB_PREFIX . "category_description SET category_id = '" . (int)$category_id . "', language_id = '" . (int)$language_id . "', name = '" . $this->db->escape($value['name']) . "', description = '" . $this->db->escape($value['description']) . "', add_description = '" . $this->db->escape($value['add_description']) . "', meta_title = '" . $this->db->escape($value['meta_title']) . "', meta_description = '" . $this->db->escape($value['meta_description']) . "', meta_keyword = '" . $this->db->escape($value['meta_keyword']) . "'");
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $sql = "SELECT cp.category_id AS category_id, GROUP_CONCAT(cd1.name ORDER BY cp.level SEPARATOR '&nbsp;&nbsp;&gt;&nbsp;&nbsp;') AS name, c1.parent_id, c1.sort_order FROM " . DB_PREFIX . "category_path cp LEFT JOIN " . DB_PREFIX . "category c1 ON (cp.category_id = c1.category_id) LEFT JOIN " . DB_PREFIX . "category c2 ON (cp.path_id = c2.category_id) LEFT JOIN " . DB_PREFIX . "category_description cd1 ON (cp.path_id = cd1.category_id) LEFT JOIN " . DB_PREFIX . "category_description cd2 ON (cp.category_id = cd2.category_id) WHERE cd1.language_id = '" . (int)$this->config->get('config_language_id') . "' AND cd2.language_id = '" . (int)$this->config->get('config_language_id') . "'";
            ]]></search>
            <add position="after"><![CDATA[
        if (isset($data['only_true_category'])) {
            $sql .= " AND c1.product_display = '0'"; //mod
        }
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
	        public function getCategoryDescriptions($category_id) {
            ]]></search>
            <add position="before"><![CDATA[
    //mod
	public function getCategoriesByParentId($parent_id = 0) {
		$query = $this->db->query("SELECT *, (SELECT COUNT(parent_id) FROM " . DB_PREFIX . "category WHERE parent_id = c.category_id) AS children FROM " . DB_PREFIX . "category c LEFT JOIN " . DB_PREFIX . "category_description cd ON (c.category_id = cd.category_id) WHERE c.parent_id = '" . (int)$parent_id . "' AND cd.language_id = '" . (int)$this->config->get('config_language_id') . "' ORDER BY c.sort_order, cd.name");

		return $query->rows;
	}

	public function editCategoryStatus($category_id, $status) {
        $this->db->query("UPDATE " . DB_PREFIX . "category SET status = '" . (int)$status . "', date_modified = NOW() WHERE category_id = '" . (int)$category_id . "'");

		$this->cache->delete('category');
    }
	//mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
			'description'      => $result['description']
            ]]></search>
            <add position="replace"><![CDATA[
                'description'      => $result['description'],
				'add_description'  => $result['add_description'] //mod
            ]]></add>
        </operation>
    </file>

    <!-- 2. PRODUCT MODEL (Admin-panel) -->

    <file path="admin/model/catalog/product.php">
        <operation>
            <search><![CDATA[
            if (isset($data['image'])) {
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        if (isset($data['thumb_width']) && isset($data['thumb_height'])) {
		    $this->db->query("UPDATE " . DB_PREFIX . "product SET thumb_width = '" . (int)$data['thumb_width'] . "', thumb_height = '" . (int)$data['thumb_height'] . "' WHERE product_id = '" . (int)$product_id . "'");
		}
		//mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $this->db->query("INSERT INTO " . DB_PREFIX . "product_to_category SET product_id = '" . (int)$product_id . "', category_id = '" . (int)$category_id . "'");
            ]]></search>
            <add position="after" offset="2"><![CDATA[
        //mod
        if (isset($data['main_category_id']) && $data['main_category_id'] > 0) {
			$this->db->query("DELETE FROM " . DB_PREFIX . "product_to_category WHERE product_id = '" . (int)$product_id . "' AND category_id = '" . (int)$data['main_category_id'] . "'");
			$this->db->query("INSERT INTO " . DB_PREFIX . "product_to_category SET product_id = '" . (int)$product_id . "', category_id = '" . (int)$data['main_category_id'] . "', main_category = '1'");
			$this->db->query("UPDATE " . DB_PREFIX . "product SET variation = '" . (int)$this->getMainCategoryInfo((int)$data['main_category_id']) . "' WHERE product_id = '" . (int)$product_id . "'");
		} elseif (isset($data['product_category'][0])) {
			$this->db->query("UPDATE " . DB_PREFIX . "product_to_category SET main_category = '1' WHERE product_id = '" . (int)$product_id . "' AND category_id = '" . (int)$data['product_category'][0] . "'");
			$this->db->query("UPDATE " . DB_PREFIX . "product SET variation = '" . (int)$this->getMainCategoryInfo((int)$data['product_category'][0]) . "' WHERE product_id = '" . (int)$product_id . "'");
		} else {
		    $this->db->query("UPDATE " . DB_PREFIX . "product SET variation = '0' WHERE product_id = '" . (int)$product_id . "'");
		}
		//mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $this->db->query("INSERT INTO " . DB_PREFIX . "product_special SET product_id = '" . (int)$product_id . "', customer_group_id = '" . (int)$product_special['customer_group_id'] . "', priority = '" . (int)$product_special['priority'] . "', price = '" . (float)$product_special['price'] . "', date_start = '" . $this->db->escape($product_special['date_start']) . "', date_end = '" . $this->db->escape($product_special['date_end']) . "'");
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            $this->db->query("INSERT INTO " . DB_PREFIX . "product_special SET product_id = '" . (int)$product_id . "', customer_group_id = '" . (int)$product_special['customer_group_id'] . "', priority = '" . (int)$product_special['priority'] . "', price = '" . (float)$product_special['price'] . "', date_start = '" . $this->db->escape($product_special['date_start']) . "', date_end = '" . $this->db->escape($product_special['date_end']) . "', logged = '" . (int)$product_special['logged'] . "'");
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
	        public function getProductFilters($product_id) {
            ]]></search>
            <add position="before"><![CDATA[
    //mod
    public function getMainCategoryInfo($category_id) {
        $query = $this->db->query("SELECT product_display FROM " . DB_PREFIX . "category WHERE category_id = '" . (int)$category_id . "' AND product_display <> '0'");

        return (!empty($query->row['product_display']) ? '1' : '0');
    }

	public function getProductMainCategoryId($product_id) {
		$query = $this->db->query("SELECT category_id FROM " . DB_PREFIX . "product_to_category WHERE product_id = '" . (int)$product_id . "' AND main_category = '1'");

		return ($query->num_rows ? (int)$query->row['category_id'] : 0);
	}

	public function editProductStatus($product_id, $status) {
        $this->db->query("UPDATE " . DB_PREFIX . "product SET status = '" . (int)$status . "', date_modified = NOW() WHERE product_id = '" . (int)$product_id . "'");

		$this->cache->delete('product');

		return $product_id;
    }
	//mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "product_to_category WHERE product_id = '" . (int)$product_id . "'");
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "product_to_category WHERE product_id = '" . (int)$product_id . "' ORDER by main_category DESC");
            ]]></add>
        </operation>
    </file>

    <!-- 3. MANUFACTURER MODEL (Admin-panel) -->

    <file path="admin/model/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[
            if (isset($data['image'])) {
            ]]></search>
            <add position="before"><![CDATA[
        //mod
    	if (isset($data['manufacturer_display'])) {
    	    $this->db->query("UPDATE " . DB_PREFIX . "manufacturer SET manufacturer_display = '" . $data['manufacturer_display'] . "' WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");
    	}

    	if (isset($data['thumb_width']) && isset($data['thumb_height'])) {
    	    $this->db->query("UPDATE " . DB_PREFIX . "manufacturer SET thumb_width = '" . (int)$data['thumb_width'] . "', thumb_height = '" . (int)$data['thumb_height'] . "' WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");
    	}
    	//mod
            ]]></add>
        </operation>
    </file>

    <!-- 4. INFORMATION MODEL (Admin-panel) -->

    <file path="admin/model/catalog/information.php">
        <operation>
            <search><![CDATA[
            $this->db->query("INSERT INTO " . DB_PREFIX . "information SET sort_order = '" . (int)$data['sort_order'] . "', bottom = '" . (isset($data['bottom']) ? (int)$data['bottom'] : 0) . "', status = '" . (int)$data['status'] . "'");
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            $this->db->query("INSERT INTO " . DB_PREFIX . "information SET sort_order = '" . (int)$data['sort_order'] . "', top = '" . (isset($data['top']) ? (int)$data['top'] : 0) . "', bottom = '" . (isset($data['bottom']) ? (int)$data['bottom'] : 0) . "', bottom_help = '" . (isset($data['bottom_help']) ? (int)$data['bottom_help'] : 0) . "', product = '" . (isset($data['product']) ? (int)$data['product'] : 0) . "', status = '" . (int)$data['status'] . "'");
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $this->db->query("UPDATE " . DB_PREFIX . "information SET sort_order = '" . (int)$data['sort_order'] . "', bottom = '" . (isset($data['bottom']) ? (int)$data['bottom'] : 0) . "', status = '" . (int)$data['status'] . "' WHERE information_id = '" . (int)$information_id . "'");
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            $this->db->query("UPDATE " . DB_PREFIX . "information SET sort_order = '" . (int)$data['sort_order'] . "', top = '" . (isset($data['top']) ? (int)$data['top'] : 0) . "', bottom = '" . (isset($data['bottom']) ? (int)$data['bottom'] : 0) . "', bottom_help = '" . (isset($data['bottom_help']) ? (int)$data['bottom_help'] : 0) . "', product = '" . (isset($data['product']) ? (int)$data['product'] : 0) . "', status = '" . (int)$data['status'] . "' WHERE information_id = '" . (int)$information_id . "'");
            ]]></add>
        </operation>
    </file>

    <!-- 5. REPORT-SALE MODEL (Admin-panel) -->

    <file path="admin/model/report/sale.php">
        <operation>
            <search><![CDATA[
		    $sql = "SELECT SUM(total) AS total FROM `" . DB_PREFIX . "order` WHERE order_status_id > '0'";
            ]]></search>
            <add position="after"><![CDATA[
        $sql .= " AND order_status_id IN (" . implode(",", $this->config->get('config_complete_status')) . ") "; //mod
            ]]></add>
        </operation>
    </file>

    <!-- *** //END MODEL (Admin-panel)// *** -->



    <!-- *** START CONTROLLER (Admin-panel) *** -->

    <!-- 1. CATEGORY CONTROLLER (Admin-panel) -->

    <file path="admin/controller/catalog/category.php">
        <operation>
            <search><![CDATA[
	        private $error = array();
            ]]></search>
            <add position="after"><![CDATA[
    //mod
	private $category_id = 0;
	private $path = array();
	//mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
	        protected function getList() {
            ]]></search>
            <add position="replace"><![CDATA[
    //mod
	protected function getList() {
        $url = '';

		$data['breadcrumbs'] = array();

		$data['breadcrumbs'][] = array(
			'text' => $this->language->get('text_home'),
			'href' => $this->url->link('common/dashboard', 'token=' . $this->session->data['token'], true)
		);

		$data['breadcrumbs'][] = array(
			'text' => $this->language->get('heading_title'),
			'href' => $this->url->link('catalog/category', 'token=' . $this->session->data['token'] . $url, true)
		);

		$data['add'] = $this->url->link('catalog/category/add', 'token=' . $this->session->data['token'] . $url, true);
		$data['delete'] = $this->url->link('catalog/category/delete', 'token=' . $this->session->data['token'] . $url, true);
		$data['repair'] = $this->url->link('catalog/category/repair', 'token=' . $this->session->data['token'] . $url, true);
		$data['enabled'] = $this->url->link('catalog/category/enable', 'token=' . $this->session->data['token'] . $url, true);
        $data['disabled'] = $this->url->link('catalog/category/disable', 'token=' . $this->session->data['token'] . $url, true);

		if (isset($this->request->get['path'])) {
			if ($this->request->get['path'] != '') {
			    $this->path = explode('_', $this->request->get['path']);
			    $this->category_id = end($this->path);
			    $this->session->data['path'] = $this->request->get['path'];
			} else {
				unset($this->session->data['path']);
			}
		} elseif (isset($this->session->data['path'])) {
		    $this->path = explode('_', $this->session->data['path']);
		    $this->category_id = end($this->path);
 		}

		$data['categories'] = $this->getCategories(0);

		$data['heading_title'] = $this->language->get('heading_title');

		$data['text_by_default'] = $this->language->get('text_by_default');
		$data['text_list'] = $this->language->get('text_list');
		$data['text_no_results'] = $this->language->get('text_no_results');
		$data['text_confirm'] = $this->language->get('text_confirm');
		$data['text_status_on'] = $this->language->get('text_status_on');
        $data['text_status_off'] = $this->language->get('text_status_off');
        $data['text_disabled'] = $this->language->get('text_disabled');
        $data['text_not_specified'] = $this->language->get('text_not_specified');
        $data['text_category_template'] = $this->language->get('text_category_template');
        $data['text_products_template'] = $this->language->get('text_products_template');
        $data['text_product_template'] = $this->language->get('text_product_template');
        $data['text_variants_template'] = $this->language->get('text_variants_template');
        $data['text_attribute_groups'] = $this->language->get('text_attribute_groups');
        $data['text_attribute_display'] = $this->language->get('text_attribute_display');
        $data['text_manufacturer'] = $this->language->get('text_manufacturer');

		$data['column_name'] = $this->language->get('column_name');
		$data['column_sort_order'] = $this->language->get('column_sort_order');
		$data['column_action'] = $this->language->get('column_action');
        $data['column_parent'] = $this->language->get('column_parent');
        $data['column_templates'] = $this->language->get('column_templates');
        $data['column_attributes'] = $this->language->get('column_attributes');
        $data['column_status'] = $this->language->get('column_status');

		$data['button_add'] = $this->language->get('button_add');
		$data['button_edit'] = $this->language->get('button_edit');
		$data['button_shop'] = $this->language->get('button_shop');
		$data['button_delete'] = $this->language->get('button_delete');
		$data['button_rebuild'] = $this->language->get('button_rebuild');
		$data['button_enable'] = $this->language->get('button_enable');
        $data['button_disable'] = $this->language->get('button_disable');

		if (isset($this->error['warning'])) {
			$data['error_warning'] = $this->error['warning'];
		} else {
			$data['error_warning'] = '';
		}

		if (isset($this->session->data['success'])) {
			$data['success'] = $this->session->data['success'];

			unset($this->session->data['success']);
		} else {
			$data['success'] = '';
		}

		if (isset($this->request->post['selected'])) {
			$data['selected'] = (array)$this->request->post['selected'];
		} else {
			$data['selected'] = array();
		}

		$category_total = $this->model_catalog_category->getTotalCategories();

		$data['results'] = $this->language->get('text_category_total') . ($category_total);
		$data['header'] = $this->load->controller('common/header');
		$data['column_left'] = $this->load->controller('common/column_left');
		$data['footer'] = $this->load->controller('common/footer');

		$this->response->setOutput($this->load->view('catalog/category_list_pro', $data));
	}

	protected function getListOriginal() { //mod
            ]]></add>
        </operation>
        <operation>
            <search index="1"><![CDATA[
            $data['text_disabled'] = $this->language->get('text_disabled');
            ]]></search>
            <add position="after"><![CDATA[
        //mod
        $data['text_by_default'] = $this->language->get('text_by_default');

        $data['tab_parent'] = $this->language->get('tab_parent');
        $data['tab_custom_template'] = $this->language->get('tab_custom_template');

        $data['entry_template'] = $this->language->get('entry_template');
        $data['entry_thumb_size'] = $this->language->get('entry_thumb_size');
        $data['entry_width'] = $this->language->get('entry_width');
        $data['entry_height'] = $this->language->get('entry_height');
        $data['entry_template_products'] = $this->language->get('entry_template_products');
        $data['entry_template_variations'] = $this->language->get('entry_template_variations');
        $data['entry_attribute_groups'] = $this->language->get('entry_attribute_groups');
        $data['entry_attribute_display'] = $this->language->get('entry_attribute_display');
        $data['entry_search_related'] = $this->language->get('entry_search_related');
        $data['entry_search_regex'] = $this->language->get('entry_search_regex');
        $data['entry_icon'] = $this->language->get('entry_icon');
        $data['entry_icon_size'] = $this->language->get('entry_icon_size');
        $data['entry_add_description'] = $this->language->get('entry_add_description');
        //mod
            ]]>
            </add>
        </operation>
        <operation>
            <search><![CDATA[
       		$this->load->model('tool/image');
            ]]></search>
            <add position="replace"><![CDATA[
        //mod
        if (isset($this->request->post['icon'])) {
		    $data['icon'] = $this->request->post['icon'];
		} elseif (!empty($category_info)) {
		    $data['icon'] = $category_info['icon'];
		} else {
		    $data['icon'] = '';
		}

		if (isset($this->request->post['icon_width'])) {
		    $data['icon_width'] = $this->request->post['icon_width'];
		} elseif (!empty($category_info)) {
		    $data['icon_width'] = $category_info['icon_width'];
		} else {
		    $data['icon_width'] = '';
		}

		if (isset($this->request->post['icon_height'])) {
		    $data['icon_height'] = $this->request->post['icon_height'];
		} elseif (!empty($category_info)) {
		    $data['icon_height'] = $category_info['icon_height'];
		} else {
		    $data['icon_height'] = '';
		}

		$this->load->model('tool/image');

		if (isset($this->request->post['icon']) && is_file(DIR_IMAGE . $this->request->post['icon'])) {
		    $data['icon_thumb'] = $this->model_tool_image->resize($this->request->post['icon'], 100, 100);
		} elseif (!empty($category_info) && is_file(DIR_IMAGE . $category_info['icon'])) {
		    $data['icon_thumb'] = $this->model_tool_image->resize($category_info['icon'], 100, 100);
		} else {
			$data['icon_thumb'] = $this->model_tool_image->resize('no_image.png', 100, 100);
		}
		//mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $this->load->model('design/layout');
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        // Attributes
		$this->load->model('catalog/attribute');

		$data['attributes'] = $this->model_catalog_attribute->getAttributes();

		if (isset($this->request->post['attribute_groups'])) {
            $data['attribute_groups'] = $this->request->post['attribute_groups'];
        } elseif (!empty($category_info)) {
            $data['attribute_groups'] = $category_info['attribute_groups'];
        } else {
            $data['attribute_groups'] = false;
        }

        if (isset($this->request->post['attribute_display'])) {
            $data['attribute_display'] = $this->request->post['attribute_display'];
        } elseif (!empty($category_info)) {
            $data['attribute_display'] = $category_info['attribute_display'];
        } else {
            $data['attribute_display'] = false;
        }

        if (isset($this->request->post['category_display'])) {
            $data['category_display'] = $this->request->post['category_display'];
        } elseif (!empty($category_info)) {
            $data['category_display'] = $category_info['category_display'];
        } else {
            $data['category_display'] = false;
        }

        if (isset($this->request->post['products_display'])) {
		    $data['products_display'] = $this->request->post['products_display'];
		} elseif (!empty($category_info)) {
		    $data['products_display'] = $category_info['products_display'];
		} else {
		    $data['products_display'] = false;
		}

        if (isset($this->request->post['product_display'])) {
		    $data['product_display'] = $this->request->post['product_display'];
		} elseif (!empty($category_info)) {
		    $data['product_display'] = $category_info['product_display'];
		} else {
		    $data['product_display'] = false;
		}

		if (isset($this->request->post['variations_display'])) {
		    $data['variations_display'] = $this->request->post['variations_display'];
		} elseif (!empty($category_info)) {
		    $data['variations_display'] = $category_info['variations_display'];
		} else {
		    $data['variations_display'] = false;
		}

        if (isset($this->request->post['thumb_width'])) {
            $data['thumb_width'] = $this->request->post['thumb_width'];
        } elseif (!empty($category_info)) {
            $data['thumb_width'] = $category_info['thumb_width'];
        } else {
            $data['thumb_width'] = '';
        }

        if (isset($this->request->post['thumb_height'])) {
            $data['thumb_height'] = $this->request->post['thumb_height'];
        } elseif (!empty($category_info)) {
            $data['thumb_height'] = $category_info['thumb_height'];
        } else {
            $data['thumb_height'] = '';
        }

        if (isset($this->request->post['search_related'])) {
		    $data['search_related'] = $this->request->post['search_related'];
		} elseif (!empty($category_info)) {
		    $data['search_related'] = $category_info['search_related'];
		} else {
		    $data['search_related'] = false;
		}

		if (isset($this->request->post['search_regex'])) {
		    $data['search_regex'] = $this->request->post['search_regex'];
		} elseif (!empty($category_info)) {
		    $data['search_regex'] = $category_info['search_regex'];
		} else {
		    $data['search_regex'] = false;
		}


		$category_templates = glob(DIR_CATALOG . 'view/theme/'  . $this->config->get('config_theme') . '/template/custom/category/*.tpl');

        $data['category_templates'] = array();

		if ($category_templates) {
          foreach ($category_templates as $template) {
            $data['category_templates'][] = array(
                'name'  => basename($template)
            );
          }
        }

        $products_templates = glob(DIR_CATALOG . 'view/theme/'  . $this->config->get('config_theme') . '/template/custom/category/category_products/*.tpl');

        $data['products_templates'] = array();

		if ($products_templates) {
          foreach ($products_templates as $template) {
            $data['products_templates'][] = array(
                'name'  => basename($template)
            );
          }
        }

		$product_templates = glob(DIR_CATALOG . 'view/theme/' . $this->config->get('config_theme') . '/template/custom/product/*.tpl');

        $data['product_templates'] = array();

        if ($product_templates) {
          foreach ($product_templates as $template) {
            $data['product_templates'][] = array(
                'name'  => basename($template)
            );
          }
        }

        $variations_templates = glob(DIR_CATALOG . 'view/theme/' . $this->config->get('config_theme') . '/template/custom/product/product_variants/*.tpl');

        $data['variations_templates'] = array();

        if ($variations_templates) {
          foreach ($variations_templates as $template) {
            $data['variations_templates'][] = array(
                'name'  => basename($template)
            );
          }
        }
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
	        protected function validateForm() {
            ]]></search>
            <add position="before"><![CDATA[
    //mod
	private function getCategories($parent_id, $parent_path = '', $indent = 0) {
		$category_id = array_shift($this->path);

		$output = array();

		static $href_category = null;
		static $href_action = null;

		if ($href_category === null) {
			$href_category = $this->url->link('catalog/category', 'token=' . $this->session->data['token'] . '&path=', true);
			$href_action = $this->url->link('catalog/category/update', 'token=' . $this->session->data['token'] . '&category_id=', true);
		}

		$results = $this->model_catalog_category->getCategoriesByParentId($parent_id);

		foreach ($results as $result) {
			$path = $parent_path . $result['category_id'];

			$href = ($result['children']) ? $href_category . $path : '';

			$name = $result['name'];

			if ($category_id == $result['category_id']) {
				$name = '<b>' . $name . '</b>';

				$data['breadcrumbs'][] = array(
					'text'      => $result['name'],
					'href'      => $href,
					'separator' => ' :: '
			    );

				$href = '';
			}

			$selected = isset($this->request->post['selected']) && in_array($result['category_id'], $this->request->post['selected']);

			$action = array();

			$action[] = array(
				'text' => $this->language->get('text_edit'),
				'href' => $href_action . $result['category_id']
			);

            $attribute_groups = array();

            if ($result['attribute_groups']) {
                $this->load->model('catalog/attribute');

                $attribute_groups = $this->model_catalog_attribute->getAttribute($result['attribute_groups']);
            }

            $attribute_display = array();

            if ($result['attribute_display']) {
                $this->load->model('catalog/attribute');

                $attribute_display = $this->model_catalog_attribute->getAttribute($result['attribute_display']);
            }

            $this->load->model('catalog/product');

            $productsCount = $this->model_catalog_product->getTotalProducts(['filter_category_id' => $result['category_id']]);

            $textProductCount = $productsCount == 0 ? '<span style="color: red; font-weight: bold">(' . $productsCount . ')</span>' : '(' . $productsCount . ')';

			$output[$result['category_id']] = array(
				'category_id'       => $result['category_id'],
				'name'              => $name . ($result['product_display'] ? ' ' . $textProductCount : null),
                'template_category' => $result['category_display'],
                'template_products' => $result['products_display'],
                'template_product'  => $result['product_display'],
                'template_variants' => $result['variations_display'],
                'attribute_groups'  => !empty($attribute_groups['name']) ? $attribute_groups['name'] : false,
                'attribute_display' => !empty($attribute_display['name']) ? $attribute_display['name'] : false,
				'sort_order'        => $result['sort_order'],
				'edit'              => $this->url->link('catalog/category/edit', 'token=' . $this->session->data['token'] . '&category_id=' . $result['category_id'], true),
				'selected'          => $selected,
				'action'            => $action,
				'href'              => $href,
				'href_shop'         => HTTP_CATALOG . 'index.php?route=product/category&path=' . ($result['category_id']),
				'indent'            => 'margin-left:' . $indent . 'px;',
				'status'            => $result['status']
			);

			if ($category_id == $result['category_id']) {
				$output += $this->getCategories($result['category_id'], $path . '_', $indent + 15);
			}
		}

		return $output;
	}

	public function enable() {
        $this->load->language('catalog/category');
        $this->document->setTitle($this->language->get('heading_title'));
        $this->load->model('catalog/category');

        if (isset($this->request->post['selected'])) {
            foreach ($this->request->post['selected'] as $category_id) {
                $this->model_catalog_category->editCategoryStatus($category_id, 1);
            }
            $this->session->data['success'] = $this->language->get('text_success');
            $url = '';
            if (isset($this->request->get['page'])) {
                $url .= '&page=' . $this->request->get['page'];
            }
            if (isset($this->request->get['sort'])) {
                $url .= '&sort=' . $this->request->get['sort'];
            }
            if (isset($this->request->get['order'])) {
                $url .= '&order=' . $this->request->get['order'];
            }
			$this->response->redirect($this->url->link('catalog/category', 'token=' . $this->session->data['token'] . $url, true));
        }

        $this->getList();
    }

    public function disable() {
        $this->load->language('catalog/category');
        $this->document->setTitle($this->language->get('heading_title'));
        $this->load->model('catalog/category');

        if (isset($this->request->post['selected'])) {
            foreach ($this->request->post['selected'] as $category_id) {
                $this->model_catalog_category->editCategoryStatus($category_id, 0);
            }
            $this->session->data['success'] = $this->language->get('text_success');
            $url = '';
            if (isset($this->request->get['page'])) {
                $url .= '&page=' . $this->request->get['page'];
            }
            if (isset($this->request->get['sort'])) {
                $url .= '&sort=' . $this->request->get['sort'];
            }
            if (isset($this->request->get['order'])) {
                $url .= '&order=' . $this->request->get['order'];
            }
            $this->response->redirect($this->url->link('catalog/category', 'token=' . $this->session->data['token'] . $url, true));
        }

        $this->getList();
    }
    //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            if ((utf8_strlen($value['meta_title']) < 3) || (utf8_strlen($value['meta_title']) > 255)) {
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            if (utf8_strlen($value['meta_title']) > 255) { //mod
            ]]></add>
        </operation>
    </file>

    <!-- 2. PRODUCT CONTROLLER (Admin-panel) -->

    <file path="admin/controller/catalog/product.php">
        <operation>
            <search><![CDATA[
            public function index() {
            ]]></search>
            <add position="after"><![CDATA[
        //mod
        $this->document->addScript('view/javascript/service.js');
        $this->document->addStyle('/catalog/view/javascript/jquery/magnific/magnific-popup.css');
        $this->document->addScript('/catalog/view/javascript/jquery/magnific/jquery.magnific-popup.min.js');
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
		    $data['delete'] = $this->url->link('catalog/product/delete', 'token=' . $this->session->data['token'] . $url, true);
            ]]></search>
            <add position="after"><![CDATA[
        //mod
		$data['enabled'] = $this->url->link('catalog/product/enable', 'token=' . $this->session->data['token'] . $url, true);
        $data['disabled'] = $this->url->link('catalog/product/disable', 'token=' . $this->session->data['token'] . $url, true);
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
		    $data['button_filter'] = $this->language->get('button_filter');
            ]]></search>
            <add position="after"><![CDATA[
        //mod
        $data['text_product_filter'] = $this->language->get('text_product_filter');

		$data['button_enable'] = $this->language->get('button_enable');
        $data['button_disable'] = $this->language->get('button_disable');

        $data['text_create_parent_product'] = $this->language->get('text_create_parent_product');
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $data['column_action'] = $this->language->get('column_action');
            ]]></search>
            <add position="after"><![CDATA[
        //mod
        $data['column_sku'] = $this->language->get('column_sku');
        $data['column_seo_url'] = $this->language->get('column_seo_url');
        $data['column_variant'] = $this->language->get('column_variant');
        $data['column_tag'] = $this->language->get('column_tag');
        $data['column_manufacturer'] = $this->language->get('column_manufacturer');
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
			$data['products'][] = array(
            ]]></search>
            <add position="before"><![CDATA[
			$tags = array();

			if ($result['tag']) {
				$tags = explode(',', $result['tag']);
			}

			$this->load->model('catalog/manufacturer');

			$manufacturer_info = $this->model_catalog_manufacturer->getManufacturer($result['manufacturer_id']);
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
		    'model'      => $result['model'],
            ]]></search>
            <add position="after"><![CDATA[
				'sku'          => $result['sku'], //mod
				'variation'    => $result['variation'], //mod
				'manufacturer' => !empty($manufacturer_info)? $manufacturer_info['name'] : null, //mod
				'tags'         => $tags, //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            'status'     => $result['status'] ? $this->language->get('text_enabled') : $this->language->get('text_disabled'),
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            'status'     => $result['status'] ? '<i class="fa fa-play"></i>' : '<i class="fa fa-pause"></i>',
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
		    $data['entry_recurring'] = $this->language->get('entry_recurring');
            ]]></search>
            <add position="after"><![CDATA[
        //mod
        $data['entry_main_category'] = $this->language->get('entry_main_category');
        $data['entry_thumb_size'] = $this->language->get('entry_thumb_size');
        $data['entry_width'] = $this->language->get('entry_width');
        $data['entry_height'] = $this->language->get('entry_height');
        $data['entry_logged'] = $this->language->get('entry_logged');
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
    		if (isset($this->request->post['location'])) {
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        if (isset($this->request->post['thumb_width'])) {
            $data['thumb_width'] = $this->request->post['thumb_width'];
        } elseif (!empty($product_info)) {
            $data['thumb_width'] = $product_info['thumb_width'];
        } else {
            $data['thumb_width'] = '';
        }

        if (isset($this->request->post['thumb_height'])) {
            $data['thumb_height'] = $this->request->post['thumb_height'];
        } elseif (!empty($product_info)) {
            $data['thumb_height'] = $product_info['thumb_height'];
        } else {
            $data['thumb_height'] = '';
        }
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
		    if (isset($this->request->post['product_category'])) {
            ]]></search>
            <add position="before"><![CDATA[
        //mod
		$data['main_category'] = array();

        if (!empty($this->request->get['product_id'])) {
		    $main_category_info = $this->model_catalog_category->getCategory($this->model_catalog_product->getProductMainCategoryId($this->request->get['product_id']));

		    if ($main_category_info) {
		        $data['main_category'] = array (
		    	    'category_id' => $main_category_info['category_id'],
		    		'name'        => ($main_category_info['path']) ? $main_category_info['path'] . ' &gt; ' . $main_category_info['name'] : $main_category_info['name']
		        );
		    }
		}
		//mod
            ]]></add>
        </operation>
        <operation>
            <search index="0"><![CDATA[
		    $this->load->model('catalog/attribute');
            ]]></search>
            <add position="replace">
        $this->load->model('catalog/attribute');
        $this->load->model('catalog/attribute_group');

        $data['attribute_groups']   = $this->model_catalog_attribute_group->getAttributeGroups(); //mod
        $data['attribute_group_id'] = $product_info['attribute_group_id']; //mod

            </add>
        </operation>
        <operation>
            <search><![CDATA[
			'price'             => $product_special['price'],
            ]]></search>
            <add position="after"><![CDATA[
				'logged'            => $product_special['logged'], //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            if ((utf8_strlen($value['meta_title']) < 3) || (utf8_strlen($value['meta_title']) > 255)) {
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            if (utf8_strlen($value['meta_title']) > 255) {
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
	        protected function validateForm() {
            ]]></search>
            <add position="before"><![CDATA[
    //mod
	public function enable() {
        $this->load->language('catalog/product');

        $this->document->setTitle($this->language->get('heading_title'));

        $this->load->model('catalog/product');

        if (isset($this->request->post['selected'])) {
            foreach ($this->request->post['selected'] as $product_id) {
                $this->model_catalog_product->editProductStatus($product_id, 1);
            }

            $this->session->data['success'] = $this->language->get('text_success');

            $url = '';

            if (isset($this->request->get['page'])) {
                $url .= '&page=' . $this->request->get['page'];
            }

            if (isset($this->request->get['sort'])) {
                $url .= '&sort=' . $this->request->get['sort'];
            }

            if (isset($this->request->get['order'])) {
                $url .= '&order=' . $this->request->get['order'];
            }

            if (isset($this->request->get['filter_category'])) {
                $url .= '&filter_category=' . $this->request->get['filter_category'];
            }

            if (isset($this->request->get['filter_manufacturer'])) {
                $url .= '&filter_manufacturer=' . $this->request->get['filter_manufacturer'];
            }

            $this->response->redirect($this->url->link('catalog/product', 'token=' . $this->session->data['token'] . $url, true));
        }

        $this->getList();
    }

    public function disable() {
        $this->load->language('catalog/product');

        $this->document->setTitle($this->language->get('heading_title'));

        $this->load->model('catalog/product');

        if (isset($this->request->post['selected'])) {
            foreach ($this->request->post['selected'] as $product_id) {
                $this->model_catalog_product->editProductStatus($product_id, 0);
            }

            $this->session->data['success'] = $this->language->get('text_success');

            $url = '';

            if (isset($this->request->get['page'])) {
                $url .= '&page=' . $this->request->get['page'];
            }

            if (isset($this->request->get['sort'])) {
                $url .= '&sort=' . $this->request->get['sort'];
            }

            if (isset($this->request->get['order'])) {
                $url .= '&order=' . $this->request->get['order'];
            }

            if (isset($this->request->get['filter_category'])) {
                $url .= '&filter_category=' . $this->request->get['filter_category'];
            }

            if (isset($this->request->get['filter_manufacturer'])) {
                $url .= '&filter_manufacturer=' . $this->request->get['filter_manufacturer'];
            }

            $this->response->redirect($this->url->link('catalog/product', 'token=' . $this->session->data['token'] . $url, true));
        }

        $this->getList();
    }
    //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            foreach ($this->request->post['product_description'] as $language_id => $value) {
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        $attributes_required = $this->config->get('dm_project_attributes_required');

        if (!empty($attributes_required)) {
            $requiredAttributeIsEmpty   = false;
            $product_attribute_post_ids = array();

            if (!empty($this->request->post['product_attribute'])) {
                foreach ($this->request->post['product_attribute'] as $product_attribute_post) {
                    $product_attribute_post_ids[] = $product_attribute_post['attribute_id'];
                }

                foreach ($attributes_required as $attribute_required_id) {
                    if (!in_array($attribute_required_id, $product_attribute_post_ids)) {
                        $requiredAttributeIsEmpty = true;
                        break;
                    }
                }
            } else {
                $requiredAttributeIsEmpty = true;
            }

            if ($requiredAttributeIsEmpty) {
                $this->load->model('catalog/attribute');

                $this->error['warning'] = "Required Attributes:";

                foreach ($attributes_required as $attribute_required_id) {
                    $this->error['warning'] .= " " . $this->model_catalog_attribute->getAttribute($attribute_required_id)['name'] . ";";
                }
            }
        }
        //mod
            ]]></add>
        </operation>
    </file>

    <!-- 3. SETTING CONTROLLER (Admin-panel) -->

    <file path="admin/controller/setting/setting.php">
        <operation>
            <search><![CDATA[
		    $data['entry_logo'] = $this->language->get('entry_logo');
            ]]></search>
            <add position="after"><![CDATA[
		$data['entry_logo_footer'] = $this->language->get('entry_logo_footer');
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
		    if (isset($this->request->post['config_icon'])) {
            ]]></search>
            <add position="before"><![CDATA[
        //mod
		if (isset($this->request->post['config_logo_footer'])) {
			$data['config_logo_footer'] = $this->request->post['config_logo_footer'];
		} else {
			$data['config_logo_footer'] = $this->config->get('config_logo_footer');
		}

		if (isset($this->request->post['config_logo_footer']) && is_file(DIR_IMAGE . $this->request->post['config_logo_footer'])) {
			$data['logo_footer'] = $this->model_tool_image->resize($this->request->post['config_logo_footer'], 100, 100);
		} elseif ($this->config->get('config_logo_footer') && is_file(DIR_IMAGE . $this->config->get('config_logo_footer'))) {
			$data['logo_footer'] = $this->model_tool_image->resize($this->config->get('config_logo_footer'), 100, 100);
		} else {
			$data['logo_footer'] = $this->model_tool_image->resize('no_image.png', 100, 100);
		}
		//mod
            ]]></add>
        </operation>
    </file>

    <!-- 4. MANUFACTURER CONTROLLER (Admin-panel) -->

    <file path="admin/controller/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[
		    $data['entry_name'] = $this->language->get('entry_name');
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        $data['text_by_default'] = $this->language->get('text_by_default');

        $data['entry_manufacturer_display'] = $this->language->get('entry_manufacturer_display');
        $data['entry_thumb_width'] = $this->language->get('entry_thumb_width');
        $data['entry_thumb_height'] = $this->language->get('entry_thumb_height');
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $this->load->model('tool/image');
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        if (isset($this->request->post['manufacturer_display'])) {
		    $data['manufacturer_display'] = $this->request->post['manufacturer_display'];
		} elseif (!empty($manufacturer_info)) {
		    $data['manufacturer_display'] = $manufacturer_info['manufacturer_display'];
		} else {
		    $data['manufacturer_display'] = false;
		}

        if (isset($this->request->post['thumb_width'])) {
            $data['thumb_width'] = $this->request->post['thumb_width'];
        } elseif (!empty($manufacturer_info)) {
            $data['thumb_width'] = $manufacturer_info['thumb_width'];
        } else {
            $data['thumb_width'] = '';
        }

        if (isset($this->request->post['thumb_height'])) {
            $data['thumb_height'] = $this->request->post['thumb_height'];
        } elseif (!empty($manufacturer_info)) {
            $data['thumb_height'] = $manufacturer_info['thumb_height'];
        } else {
            $data['thumb_height'] = '';
        }

		$manufacturer_templates = glob(DIR_CATALOG . 'view/theme/' . $this->config->get('config_theme') . '/template/custom/manufacturer/*.tpl');

        $data['manufacturer_templates'] = array();

		if ($manufacturer_templates) {
            foreach ($manufacturer_templates as $template) {
                $data['manufacturer_templates'][] = array(
                    'name'  => basename($template)
                );
            }
        }
        //mod
            ]]></add>
        </operation>
    </file>

    <!-- 5. FEATURED MODULE CONTROLLER (Admin-panel) -->

    <file path="admin/controller/extension/module/featured.php">
        <operation>
            <search><![CDATA[
		    $data['text_disabled'] = $this->language->get('text_disabled');
            ]]></search>
            <add position="after"><![CDATA[
        //mod
        $data['text_disabled'] = $this->language->get('text_disabled');
        $data['text_by_default'] = $this->language->get('text_by_default');

        $data['entry_heading'] = $this->language->get('entry_heading');
        $data['entry_category'] = $this->language->get('entry_category');
        $data['entry_display'] = $this->language->get('entry_display');
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
    		$this->load->model('catalog/product');
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        if (isset($this->request->post['heading'])) {
            $data['heading'] = $this->request->post['heading'];
        } elseif (!empty($module_info)) {
            $data['heading'] = $module_info['heading'];
        } else {
            $data['heading'] = '';
        }
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            if (isset($this->request->post['limit'])) {
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        $this->load->model('catalog/category');

        $data['categories'] = array();

		$categories = $this->model_catalog_category->getCategories();

        foreach ($categories as $category) {
            $data['categories'][] = array(
                'category_id' => $category['category_id'],
                'name'        => $category['name']
            );
        }

        if (isset($this->request->post['category_selected'])) {
            $data['category_selected'] = $this->request->post['category_selected'];
        } elseif (!empty($module_info)) {
            $data['category_selected'] = $module_info['category_selected'];
        } else {
            $data['category_selected'] = '';
        }
        //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
    		$data['header'] = $this->load->controller('common/header');
            ]]></search>
            <add position="before"><![CDATA[
        //mod
        if (isset($this->request->post['display'])) {
            $data['display'] = $this->request->post['display'];
        } elseif (!empty($module_info)) {
            $data['display'] = $module_info['display'];
        } else {
            $data['display'] = '';
        }

		$templates = glob(DIR_CATALOG . 'view/theme/' . $this->config->get('config_theme') . '/template/custom/module/featured_*.tpl');

        $data['custom_templates'] = array();

        if ($templates) {
            foreach ($templates as $template) {
                $data['custom_templates'][] = array(
                    'name'  => basename($template)
                );
            }
        }
        //mod
            ]]></add>
        </operation>
    </file>

    <!-- 6.  INFORMATION CONTROLLER (Admin-panel) -->

    <file path="admin/controller/catalog/information.php">
        <operation>
            <search><![CDATA[
		    $data['entry_layout'] = $this->language->get('entry_layout');
            ]]></search>
            <add position="after"><![CDATA[
        //information top mod
        $data['entry_bottom_help'] = $this->language->get('entry_bottom_help');
		$data['entry_top'] = $this->language->get('entry_top');
        $data['entry_product'] = $this->language->get('entry_product');

        $data['help_bottom_help'] = $this->language->get('help_bottom_help');
		$data['help_top'] = $this->language->get('help_top');
		$data['help_product'] = $this->language->get('help_product');
		//information top mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
		    if (isset($this->request->post['bottom'])) {
            ]]></search>
            <add position="before"><![CDATA[
        //information top mod
		if (isset($this->request->post['top'])) {
			$data['top'] = $this->request->post['top'];
		} elseif (!empty($information_info)) {
			$data['top'] = $information_info['top'];
		} else {
			$data['top'] = 0;
		}

		if (isset($this->request->post['bottom_help'])) {
			$data['bottom_help'] = $this->request->post['bottom_help'];
		} elseif (!empty($information_info)) {
			$data['bottom_help'] = $information_info['bottom_help'];
		} else {
			$data['bottom_help'] = 0;
		}

		if (isset($this->request->post['product'])) {
			$data['product'] = $this->request->post['product'];
		} elseif (!empty($information_info)) {
			$data['product'] = $information_info['product'];
		} else {
			$data['product'] = 0;
		}
        //information top mod
            ]]></add>
        </operation>
    </file>

    <!-- 7.  DESIGN CONTROLLER (Admin-panel) -->

    <file path="admin/controller/design/layout.php">
        <operation>
            <search><![CDATA[
		    $data['text_content_top'] = $this->language->get('text_content_top');
            ]]>
            </search>
            <add position="after"><![CDATA[
        $data['text_content_middle'] = $this->language->get('text_content_middle');
            ]]>
            </add>
        </operation>
    </file>

    <!-- 8. SALE-ORDER CONTROLLER (Admin-panel) -->

    <file path="admin/controller/sale/order.php">
        <operation>
            <search><![CDATA[
            'date_modified' => date($this->language->get('date_format_short'), strtotime($result['date_modified'])),
            ]]></search>
            <add position="replace" offset="-1"><![CDATA[
				'date_added'    => date($this->language->get('datetime_format'), strtotime($result['date_added'])), //mod
				'date_modified' => date($this->language->get('datetime_format'), strtotime($result['date_modified'])), //mod
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $data['date_added'] = date($this->language->get('date_format_short'), strtotime($order_info['date_added']));
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            $data['date_added'] = date($this->language->get('datetime_format'), strtotime($order_info['date_added'])); //mod
            ]]></add>
        </operation>
    </file>

    <!-- 9. ATTRIBUTE CONTROLLER (Admin-panel) -->

    <file path="admin/controller/catalog/attribute.php">
        <operation>
            <search><![CDATA[
            public function autocomplete() {
            ]]></search>
            <add position="before"><![CDATA[
    //mod
    public function getGroupAttributes() {
        $this->load->model('catalog/attribute');

        $results = $this->model_catalog_attribute->getAttributes([
            'filter_attribute_group_id' => (int)$this->request->post['attribute_group_id'],
        ]);

        $attributes = array();

        foreach ($results as $attribute) {
            $attributes[] = [
                'attribute_id'  => $attribute['attribute_id'],
                'name'          => $attribute['name'],
            ];
        }

        $this->response->addHeader('Content-Type: application/json');
        $this->response->setOutput(json_encode($attributes));
    }
    //mod
            ]]></add>
        </operation>
    </file>

    <!-- *** //END CONTROLLER (Admin-panel)// *** -->



    <!-- *** START TEMPLATE (Admin) *** -->

    <!-- 1. CATEGORY TEMPLATE (Admin-panel) -->

    <file path="admin/view/template/catalog/category_form.tpl">
        <operation>
            <search><![CDATA[
            <li><a href="#tab-design" data-toggle="tab"><?php echo $tab_design; ?></a></li>
            ]]></search>
            <add position="after"><![CDATA[
            <li><a href="#tab-template" data-toggle="tab"><?php echo $tab_custom_template; ?></a></li>
            <li><a href="#tab-parent" data-toggle="tab"><?php echo $tab_parent; ?></a></li>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <div class="tab-pane" id="tab-design">
            ]]></search>
            <add position="before"><![CDATA[
            <div class="tab-pane" id="tab-template">
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-category-display"><?php echo $entry_template; ?></label>
                    <div class="col-sm-10">
                        <select name="category_display" id="input-category-display" class="form-control">
                        <?php if ($category_templates) { ?>
                        <?php foreach ($category_templates as $template) { ?>
                            <option <?php echo $template['name'] == $category_display ? 'selected' : false; ?> value="<?php echo $template['name']; ?>"><?php echo $template['name']; ?></option>
                        <?php } ?>
                        <?php } ?>
                        <option <?php  echo !$category_display ? 'selected' : false; ?> value="0" ><?php echo $text_by_default; ?></option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-products-display"><?php echo $entry_template_products; ?></label>
                    <div class="col-sm-10">
                        <select name="products_display" id="input-products-display" class="form-control">
                           <?php if ($products_templates) { ?>
                           <?php foreach ($products_templates as $template) { ?>
                               <option <?php echo $template['name'] == $products_display ? 'selected' : false; ?> value="<?php echo $template['name']; ?>"><?php echo $template['name']; ?></option>
                           <?php } ?>
                           <?php } ?>
                           <option <?php  echo !$products_display ? 'selected' : false; ?> value="0" ><?php echo $text_by_default; ?></option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-thumb-width"><?php echo $entry_thumb_size; ?></label>
                    <div class="col-sm-10">
                        <div class="row">
                            <div class="col-sm-6">
                                <input type="text" name="thumb_width" value="<?php echo $thumb_width; ?>" placeholder="<?php echo $entry_width; ?>" id="input-thumb-width" class="form-control" />
                            </div>
                            <div class="col-sm-6">
                                <input type="text" name="thumb_height" value="<?php echo $thumb_height; ?>" placeholder="<?php echo $entry_height; ?>" id="input-thumb-height" class="form-control" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane" id="tab-parent">
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-product-display"><?php echo $entry_template; ?></label>
                    <div class="col-sm-10">
                        <select name="product_display" id="input-product-display" class="form-control">
                           <?php if ($product_templates) { ?>
                           <?php foreach ($product_templates as $template) { ?>
                               <option <?php echo $template['name'] == $product_display ? 'selected' : false; ?> value="<?php echo $template['name']; ?>"><?php echo $template['name']; ?></option>
                           <?php } ?>
                           <?php } ?>
                           <option <?php  echo !$product_display ? 'selected' : false; ?> value="0" ><?php echo $text_disabled; ?></option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-variations-display"><?php echo $entry_template_variations; ?></label>
                    <div class="col-sm-10">
                        <select name="variations_display" id="input-variations-display" class="form-control">
                           <?php if ($variations_templates) { ?>
                           <?php foreach ($variations_templates as $template) { ?>
                               <option <?php echo $template['name'] == $variations_display ? 'selected' : false; ?> value="<?php echo $template['name']; ?>"><?php echo $template['name']; ?></option>
                           <?php } ?>
                           <?php } ?>
                           <option <?php  echo !$variations_display ? 'selected' : false; ?> value="0" ><?php echo $text_by_default; ?></option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-attribute-groups"><?php echo $entry_attribute_groups; ?></label>
                    <div class="col-sm-10">
                        <select name="attribute_groups" id="input-attribute-groups" class="form-control">
                            <?php if ($attributes) { ?>
                            <?php foreach ($attributes as $attribute) { ?>
                                <option <?php echo $attribute['attribute_id'] == $attribute_groups ? 'selected' : false; ?> value="<?php echo $attribute['attribute_id']; ?>"><?php echo $attribute['name']; ?> (<?php echo $attribute['attribute_group']; ?>)</option>
                            <?php } ?>
                            <?php } ?>
                            <option <?php  echo !$attribute_groups ? 'selected' : false; ?> value="0"><?php echo $text_disabled; ?></option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-attribute-display"><?php echo $entry_attribute_display; ?></label>
                    <div class="col-sm-10">
                        <select name="attribute_display" id="input-attribute-display" class="form-control">
                            <?php if ($attributes) { ?>
                            <?php foreach ($attributes as $attribute) { ?>
                                <option <?php echo $attribute['attribute_id'] == $attribute_display ? 'selected' : false; ?> value="<?php echo $attribute['attribute_id']; ?>"><?php echo $attribute['name']; ?> (<?php echo $attribute['attribute_group']; ?>)</option>
                            <?php } ?>
                            <?php } ?>
                            <option <?php  echo !$attribute_display ? 'selected' : false; ?> value="0"><?php echo $text_disabled; ?></option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-search-related"><?php echo $entry_search_related; ?></label>
                    <div class="col-sm-10">
                        <select name="search_related" id="input-search-related" class="form-control">
                            <?php if ($search_related) { ?>
                            <option value="1" selected="selected"><?php echo $text_enabled; ?></option>
                            <option value="0"><?php echo $text_disabled; ?></option>
                            <?php } else { ?>
                            <option value="1"><?php echo $text_enabled; ?></option>
                            <option value="0" selected="selected"><?php echo $text_disabled; ?></option>
                            <?php } ?>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-search-regex"><?php echo $entry_search_regex; ?></label>
                    <div class="col-sm-10">
                        <input type="text" name="search_regex" value="<?php echo $search_regex ? $search_regex : ''; ?>" placeholder="<?php echo $entry_search_regex; ?>" id="input-search-regex" class="form-control">
                    </div>
                </div>
            </div>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <input type="hidden" name="image" value="<?php echo $image; ?>" id="input-image" />
			]]></search>
            <add position="after" offset="2"><![CDATA[
              <div class="form-group">
                  <label class="col-sm-2 control-label"><?php echo $entry_icon; ?></label>
                  <div class="col-sm-10"><a href="" id="thumb-icon" data-toggle="image" class="img-thumbnail"><img src="<?php echo $icon_thumb; ?>" alt="" title="" data-placeholder="<?php echo $placeholder; ?>" /></a>
                    <input type="hidden" name="icon" value="<?php echo $icon; ?>" id="input-icon" />
                  </div>
              </div>
              <div class="form-group">
                  <label class="col-sm-2 control-label" for="input-icon-width"><?php echo $entry_icon_size; ?></label>
                  <div class="col-sm-10">
                    <div class="row">
                        <div class="col-sm-6">
                            <input type="text" name="icon_width" value="<?php echo $icon_width; ?>" placeholder="<?php echo $entry_width; ?>" id="input-icon-width" class="form-control" />
                        </div>
                        <div class="col-sm-6">
                            <input type="text" name="icon_height" value="<?php echo $icon_height; ?>" placeholder="<?php echo $entry_height; ?>" id="input-icon-height" class="form-control" />
                        </div>
                    </div>
                  </div>
              </div>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <textarea name="category_description[<?php echo $language['language_id']; ?>][description]" placeholder="<?php echo $entry_description; ?>" id="input-description<?php echo $language['language_id']; ?>" class="form-control summernote"><?php echo isset($category_description[$language['language_id']]) ? $category_description[$language['language_id']]['description'] : ''; ?></textarea>
            ]]></search>
            <add position="after" offset="2"><![CDATA[
                  <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-add-description<?php echo $language['language_id']; ?>"><?php echo $entry_add_description; ?></label>
                    <div class="col-sm-10">
                      <textarea name="category_description[<?php echo $language['language_id']; ?>][add_description]" placeholder="<?php echo $entry_add_description; ?>" id="input-add-description<?php echo $language['language_id']; ?>" class="form-control summernote"><?php echo isset($category_description[$language['language_id']]) ? $category_description[$language['language_id']]['add_description'] : ''; ?></textarea>
                    </div>
                  </div>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <label class="col-sm-2 control-label" for="input-meta-title<?php echo $language['language_id']; ?>"><?php echo $entry_meta_title; ?></label>
            ]]></search>
            <add position="replace" offset="-1"><![CDATA[
                  <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-title<?php echo $language['language_id']; ?>"><?php echo $entry_meta_title; ?></label>
            ]]></add>
        </operation>
    </file>

    <!-- 2. PRODUCT TEMPLATE (Admin-panel) -->

    <file path="admin/view/template/catalog/product_list.tpl">
        <operation>
            <search><![CDATA[
            <div class="pull-right"><a href="<?php echo $add; ?>" data-toggle="tooltip" title="<?php echo $button_add; ?>" class="btn btn-primary"><i class="fa fa-plus"></i></a>
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            <div class="pull-right">
                <a href="<?php echo $add; ?>" data-toggle="tooltip" title="<?php echo $button_add; ?>" class="btn btn-primary"><i class="fa fa-plus"></i></a>
            </div>
            <div class="product-menu-bottom fixed">
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <button type="button" data-toggle="tooltip" title="<?php echo $button_delete; ?>" class="btn btn-danger" onclick="confirm('<?php echo $text_confirm; ?>') ? $('#form-product').submit() : false;"><i class="fa fa-trash-o"></i></button>
            ]]></search>
            <add position="before"><![CDATA[
        <button type="button" data-toggle="tooltip" title="<?php echo $text_create_parent_product; ?>" class="btn btn-success btn-create-parent" onclick="createParentProduct('<?php echo $token ?>'); "><i class="fa fa-plus" aria-hidden="true"></i> <?php echo $text_create_parent_product ?></button>
        <button type="button" data-toggle="tooltip" title="<?php echo $button_enable; ?>" class="btn btn-default" onclick="$('#form-product').attr('action', '<?php echo $enabled; ?>').submit()"><i class="fa fa-play"></i></button>
		<button type="button" data-toggle="tooltip" title="<?php echo $button_disable; ?>" class="btn btn-default" onclick="$('#form-product').attr('action', '<?php echo $disabled; ?>').submit()"><i class="fa fa-pause"></i></button>
            ]]></add>
        </operation>
        <operation>
            <search index="0"><![CDATA[
            <div class="well">
            ]]></search>
            <add position="before"><![CDATA[
        <h4 class="panel-title">
          <a class="btn btn-default" data-toggle="collapse" data-parent="#accordion" href="#productFilter">
            <i class="fa fa-filter" aria-hidden="true"></i> <?php echo $text_product_filter; ?>
          </a>
        </h4>
        <br>
        <div id="productFilter" class="panel-collapse collapse">
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <form action="<?php echo $delete; ?>" method="post" enctype="multipart/form-data" id="form-product">
            ]]></search>
            <add position="before"><![CDATA[
        </div>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <td class="text-right"><?php if ($sort == 'p.price') { ?>
            ]]></search>
            <add position="before"><![CDATA[
                  <td class="text-left"><?php echo $column_sku; ?></td>
                  <td class="text-center"><?php echo $column_variant; ?></td>
                  <td class="text-left"><?php echo $column_tag; ?></td>
                  <td class="text-center"><?php echo $column_manufacturer; ?></td>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <td class="text-left"><?php echo $product['model']; ?></td>
            ]]></search>
            <add position="after"><![CDATA[
                  <td class="text-left"><?php echo $product['sku']; ?></td>
                  <td class="text-center">
                    <?php echo $product['variation'] ? '<i class="fa fa-check-square-o" aria-hidden="true"></i>' : ''; ?>
                  </td>
                  <td>
                    <?php if ($product['tags']) { ?>
                    <p>
                      <?php for ($i = 0; $i < count($product['tags']); $i++) { ?>
                      <?php if ($i < (count($product['tags']) - 1)) { ?>
                      <span><?php echo $product['tags'][$i]; ?></span>,
                      <?php } else { ?>
                      <span><?php echo $product['tags'][$i]; ?></span>
                      <?php } ?>
                      <?php } ?>
                    </p>
                    <?php } ?>
                  </td>
                  <td class="text-center"><?php echo $product['manufacturer']; ?></td>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <?php echo $category['name'];?><br>
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
                <a href="#" onclick="event.preventDefault(); quickEditParentProduct('<?php echo $category['category_id'] ?>', '<?php echo $token; ?>')"><?php echo $category['name'];?></a><br>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <td class="text-center" colspan="8"><?php echo $text_no_results; ?></td>
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            <td class="text-center" colspan="11"><?php echo $text_no_results; ?></td>
            ]]></add>
        </operation>

        <operation>
            <search><![CDATA[
            $('#button-filter').on('click', function() {
            ]]></search>
            <add position="before"><![CDATA[
$('#form-product input[type=\'checkbox\']').change(function () {
  var selected = $('#form-product').serialize();

  if (selected !== "") {
    $('.product-menu-bottom.fixed').css('display', 'block');
  } else {
    $('.product-menu-bottom.fixed').css('display', 'none');
  }
});
            ]]></add>
        </operation>
    </file>

    <file path="admin/view/template/catalog/product_form.tpl">
        <operation>
            <search><![CDATA[
            <label class="col-sm-2 control-label" for="input-meta-title<?php echo $language['language_id']; ?>"><?php echo $entry_meta_title; ?></label>
            ]]></search>
            <add position="replace" offset="-1"><![CDATA[
                  <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-title<?php echo $language['language_id']; ?>"><?php echo $entry_meta_title; ?></label>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <label class="col-sm-2 control-label" for="input-sort-order"><?php echo $entry_sort_order; ?></label>
            ]]></search>
            <add position="before" offset="1"><![CDATA[
              <div class="form-group">
                  <label class="col-sm-2 control-label" for="input-thumb-width"><?php echo $entry_thumb_size; ?></label>
                  <div class="col-sm-10">
                      <div class="row">
                          <div class="col-sm-6">
                              <input type="text" name="thumb_width" value="<?php echo $thumb_width; ?>" placeholder="<?php echo $entry_width; ?>" id="input-thumb-width" class="form-control" />
                          </div>
                          <div class="col-sm-6">
                              <input type="text" name="thumb_height" value="<?php echo $thumb_height; ?>" placeholder="<?php echo $entry_height; ?>" id="input-thumb-height" class="form-control" />
                          </div>
                      </div>
                  </div>
              </div>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <label class="col-sm-2 control-label" for="input-category"><span data-toggle="tooltip" title="<?php echo $help_category; ?>"><?php echo $entry_category; ?></span></label>
            ]]></search>
            <add position="before" offset="1"><![CDATA[
			  <div class="form-group">
				<label class="col-sm-2 control-label" for="input-main-category"><?php echo $entry_main_category; ?></label>
                <div class="col-sm-10">
                  <input type="text" name="main_category" value="" placeholder="<?php echo $entry_main_category; ?>" id="input-main-category" class="form-control" />
                  <div id="product-main-category" class="well well-sm" style="height: 60px; overflow: auto;">
                    <?php if ($main_category) { ?>
                        <div id="product-main-category<?php echo $main_category['category_id']; ?>"><i class="fa fa-minus-circle"></i> <?php echo $main_category['name']; ?>
                          <input type="hidden" name="main_category_id" value="<?php echo $main_category['category_id']; ?>" />
                        </div>
                    <?php } ?>
                  </div>
                </div>
			  </div>
            ]]></add>
        </operation>
        <operation>
            <search index="1"><![CDATA[
            <td class="text-left"><?php echo $entry_date_end; ?></td>
            ]]></search>
            <add position="after"><![CDATA[
                      <td class="text-left"><?php echo $entry_logged; ?></td>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <td class="text-left"><button type="button" onclick="addAttribute();" data-toggle="tooltip" title="<?php echo $button_attribute_add; ?>" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
            ]]></search>
            <add position="replace" offset="-1"><![CDATA[
                      <td colspan="2">
                          <select name="attribute_group_id" id="input-attribute-group" class="form-control">
                              <option value="0"></option>
                              <?php foreach ($attribute_groups as $attribute_group) { ?>
                              <?php if ($attribute_group['attribute_group_id'] == $attribute_group_id) { ?>
                              <option value="<?php echo $attribute_group['attribute_group_id']; ?>" selected="selected"><?php echo $attribute_group['name']; ?></option>
                              <?php } else { ?>
                              <option value="<?php echo $attribute_group['attribute_group_id']; ?>"><?php echo $attribute_group['name']; ?></option>
                              <?php } ?>
                              <?php } ?>
                          </select>
                      </td>
                      <td class="text-left"><button type="button" onclick="addAttribute();" data-toggle="tooltip" title="<?php echo $button_attribute_add; ?>" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>

            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <td class="text-left"><button type="button" onclick="$('#special-row<?php echo $special_row; ?>').remove();" data-toggle="tooltip" title="<?php echo $button_remove; ?>" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
            ]]></search>
            <add position="before"><![CDATA[
                      <td class="text-left"><select name="product_special[<?php echo $special_row; ?>][logged]" class="form-control">
                          <option value="0"><?php echo $text_disabled; ?></option>
                          <option <?php echo $product_special['logged'] ? 'selected' : false; ?> value="1"><?php echo $text_enabled; ?></option>
                      </select></td>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <td colspan="5"></td>
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
            <td colspan="6"></td>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
	html += '  <td class="text-left" style="width: 20%;"><div class="input-group date"><input type="text" name="product_special[' + special_row + '][date_end]" value="" placeholder="<?php echo $entry_date_end; ?>" data-date-format="YYYY-MM-DD" class="form-control" /><span class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span></div></td>';
            ]]></search>
            <add position="after"><![CDATA[
    html += '  <td class="text-left"><select name="product_special[' + special_row + '][logged]" class="form-control">';
    html += '      <option value="0"><?php echo $text_disabled; ?></option>';
    html += '      <option value="1"><?php echo $text_enabled; ?></option>';
    html += '  </select></td>';
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $('input[name=\'filter\']').autocomplete({
            ]]></search>
            <add position="before" offset="1"><![CDATA[
//Main Category
$('input[name=\'main_category\']').autocomplete({
    'source': function(request, response) {
        $.ajax({
            url: 'index.php?route=catalog/category/autocomplete&token=<?php echo $token; ?>&filter_name=' +  encodeURIComponent(request),
            dataType: 'json',
            success: function(json) {
                response($.map(json, function(item) {
                    return {
                        label: item['name'],
                        value: item['category_id']
                    }
                }));
            }
        });
    },
    'select': function(item) {
        $('input[name=\'main_category\']').val('');

        $('#product-main-category' + item['value']).remove();

        $('#product-main-category').html('<div id="product-main-category' + item['value'] + '"><i class="fa fa-minus-circle"></i> ' + item['label'] + '<input type="hidden" name="main_category_id" value="' + item['value'] + '" /></div>');
    }
});

$('#product-main-category').delegate('.fa-minus-circle', 'click', function() {
    $(this).parent().remove();
});
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            var attribute_row = <?php echo $attribute_row; ?>;
            ]]></search>
            <add position="replace"><![CDATA[
let attribute_row = '<?php echo $attribute_row; ?>';

$('select#input-attribute-group').change(function () {
    attribute_row = 0;

    let attribute_group_id = $(this).val();

    if (Number(attribute_group_id) === 0) {
        $('#attribute tbody').empty();
        $('button#attribute-add').removeAttr('disabled');
    } else {
        $.ajax({
            url: 'index.php?route=catalog/attribute/getGroupAttributes&token=' + getURLVar('token'),
            method: 'post',
            data: { attribute_group_id: attribute_group_id },
            success: function (attributes) {
                $('#attribute tbody').empty();
                $('button#attribute-add').attr('disabled', 'disabled');

                addGroupAttributes(attributes);
            }
        });
    }
});

function addGroupAttributes(attributes) {
    attributes.forEach(function (item) {
        html  = '<tr id="attribute-row' + attribute_row + '">';
        html += '  <td class="text-left" style="width: 20%;"><input disabled type="text" name="product_attribute[' + attribute_row + '][name]" value="' + item.name + '" placeholder="<?php echo $entry_attribute; ?>" class="form-control" /><input type="hidden" name="product_attribute[' + attribute_row + '][attribute_id]" value="' + item.attribute_id + '" /></td>';
        html += '  <td class="text-left">';
        '<?php foreach ($languages as $language) { ?>'
        html += '<div class="input-group"><span class="input-group-addon"><img src="language/<?php echo $language['code']; ?>/<?php echo $language['code']; ?>.png" title="<?php echo $language['name']; ?>" /></span><textarea name="product_attribute[' + attribute_row + '][product_attribute_description][<?php echo $language['language_id']; ?>][text]" rows="5" placeholder="<?php echo $entry_text; ?>" class="form-control"></textarea></div>';
        '<?php } ?>'
        html += '  </td>';
        html += '  <td class="text-left"><button type="button" disabled onclick="$(\'#attribute-row' + attribute_row + '\').remove();" data-toggle="tooltip" title="<?php echo $button_remove; ?>" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
        html += '</tr>';

        $('#attribute tbody').append(html);

        attributeautocomplete(attribute_row);

        attribute_row++;
    });
}
            ]]></add>
        </operation>
    </file>

    <!-- 3. MANUFACTURER TEMPLATE (Admin-panel) -->

    <file path="admin/view/template/catalog/manufacturer_form.tpl">
        <operation>
            <search><![CDATA[
            <input type="text" name="sort_order" value="<?php echo $sort_order; ?>" placeholder="<?php echo $entry_sort_order; ?>" id="input-sort-order" class="form-control" />
            ]]></search>
            <add position="after" offset="2"><![CDATA[
            <div class="form-group">
                <label class="col-sm-2 control-label" for="input-manufacturer-display"><?php echo $entry_manufacturer_display; ?></label>
                <div class="col-sm-10">
                    <select name="manufacturer_display" id="input-manufacturer-display" class="form-control">
                    <?php if ($manufacturer_templates) { ?>
                    <?php foreach ($manufacturer_templates as $template) { ?>
                        <option <?php echo $template['name'] == $manufacturer_display ? 'selected' : false; ?> value="<?php echo $template['name']; ?>"><?php echo $template['name']; ?></option>
                    <?php } ?>
                    <?php } ?>
                    <option <?php  echo !$manufacturer_display ? 'selected' : false; ?> value="0" ><?php echo $text_by_default; ?></option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label" for="input-thumb-width"><?php echo $entry_thumb_width; ?></label>
                <div class="col-sm-10">
                    <input type="text" name="thumb_width" value="<?php echo $thumb_width; ?>" placeholder="<?php echo $entry_thumb_width; ?>" id="input-thumb-width" class="form-control" />
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label" for="input-thumb-height"><?php echo $entry_thumb_height; ?></label>
                <div class="col-sm-10">
                    <input type="text" name="thumb_height" value="<?php echo $thumb_height; ?>" placeholder="<?php echo $entry_thumb_height; ?>" id="input-thumb-height" class="form-control" />
                </div>
            </div>
            ]]></add>
        </operation>
    </file>

    <!-- 4. SETTING TEMPLATE (Admin-panel) -->

    <file path="admin/view/template/setting/setting.tpl">
        <operation>
            <search><![CDATA[
            <input type="hidden" name="config_logo" value="<?php echo $config_logo; ?>" id="input-logo" />
            ]]></search>
            <add position="after" offset="2"><![CDATA[
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-logo-footer"><?php echo $entry_logo_footer; ?></label>
                <div class="col-sm-10"><a href="" id="thumb-logo-footer" data-toggle="image" class="img-thumbnail"><img src="<?php echo $logo_footer; ?>" alt="" title="" data-placeholder="<?php echo $placeholder; ?>" /></a>
                  <input type="hidden" name="config_logo_footer" value="<?php echo $config_logo_footer; ?>" id="input-logo-footer" />
                </div>
              </div>
            ]]></add>
        </operation>
    </file>

    <!-- 4. FEATURED MODULE TEMPLATE (Admin-panel) -->

    <file path="admin/view/template/extension/module/featured.tpl">
        <operation>
            <search><![CDATA[
            <label class="col-sm-2 control-label" for="input-product"><span data-toggle="tooltip" title="<?php echo $help_product; ?>"><?php echo $entry_product; ?></span></label>
            ]]></search>
            <add position="before" offset="1"><![CDATA[
          <div class="form-group">
              <label class="col-sm-2 control-label" for="input-heading"><?php echo $entry_heading; ?></label>
              <div class="col-sm-10">
                  <select name="heading" id="input-heading" class="form-control">
                  <?php if ($heading) { ?>
                      <option value="1" selected="selected"><?php echo $text_enabled; ?></option>
                      <option value="0"><?php echo $text_disabled; ?></option>
                  <?php } else { ?>
                      <option value="1"><?php echo $text_enabled; ?></option>
                      <option value="0" selected="selected"><?php echo $text_disabled; ?></option>
                  <?php } ?>
                  </select>
              </div>
          </div>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <label class="col-sm-2 control-label" for="input-limit"><?php echo $entry_limit; ?></label>
            ]]></search>
            <add position="before" offset="1"><![CDATA[
          <div class="form-group">
              <label class="col-sm-2 control-label" for="input-category"><?php echo $entry_category; ?></label>
              <div class="col-sm-10">
                  <select name="category_selected" id="input-category" class="form-control">
                  <?php if ($categories) { ?>
                    <?php foreach ($categories as $category) { ?>
                      <option <?php echo $category['category_id'] == $category_selected ? 'selected' : false; ?> value="<?echo $category['category_id']; ?>"><?php echo $category['name']; ?></option>
                    <?php } ?>
                  <?php } ?>
                  <option <?php echo !$category_selected ? 'selected' : false; ?> value="0"><?php echo $text_disabled; ?></option>
                  </select>
              </div>
          </div>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            <label class="col-sm-2 control-label" for="input-status"><?php echo $entry_status; ?></label>
            ]]></search>
            <add position="before" offset="1"><![CDATA[
          <div class="form-group">
              <label class="col-sm-2 control-label" for="input-display"><?php echo $entry_display; ?></label>
              <div class="col-sm-10">
                  <select name="display" id="input-display" class="form-control">
                  <?php if ($custom_templates) { ?>
                  <?php foreach ($custom_templates as $template) { ?>
                      <option <?php echo $template['name'] == $display ? 'selected' : false; ?> value="<?php echo $template['name']; ?>"><?php echo $template['name']; ?></option>
                  <?php } ?>
                  <?php } ?>
                  <option <?php  echo !$display ? 'selected' : false; ?> value="0" ><?php echo $text_by_default; ?></option>
                </select>
              </div>
          </div>
            ]]></add>
        </operation>
    </file>

    <!-- 5. INFORMATION TEMPLATE (Admin-panel) -->

    <file path="admin/view/template/catalog/information_form.tpl">
        <operation>
            <search><![CDATA[
            <label class="col-sm-2 control-label" for="input-status"><?php echo $entry_status; ?></label>
            ]]></search>
            <add position="before" offset="1"><![CDATA[
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-bottom-help"><span data-toggle="tooltip" title="<?php echo $help_bottom_help; ?>"><?php echo $entry_bottom_help; ?></span></label>
                <div class="col-sm-10">
                  <div class="checkbox">
                    <label>
                      <?php if ($bottom_help) { ?>
                      <input type="checkbox" name="bottom_help" value="1" checked="checked" id="input-bottom-help" />
                      <?php } else { ?>
                      <input type="checkbox" name="bottom_help" value="1" id="input-bottom-help" />
                      <?php } ?>
                      &nbsp; </label>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-top"><span data-toggle="tooltip" title="<?php echo $help_top; ?>"><?php echo $entry_top; ?></span></label>
                <div class="col-sm-10">
                  <div class="checkbox">
                    <label>
                      <?php if ($top) { ?>
                      <input type="checkbox" name="top" value="1" checked="checked" id="input-top" />
                      <?php } else { ?>
                      <input type="checkbox" name="top" value="1" id="input-top" />
                      <?php } ?>
                      &nbsp; </label>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label" for="input-product"><span data-toggle="tooltip" title="<?php echo $help_product; ?>"><?php echo $entry_product; ?></span></label>
                <div class="col-sm-10">
                  <div class="checkbox">
                    <label>
                      <?php if ($product) { ?>
                      <input type="checkbox" name="product" value="1" checked="checked" id="input-product" />
                      <?php } else { ?>
                      <input type="checkbox" name="product" value="1" id="input-product" />
                      <?php } ?>
                      &nbsp; </label>
                  </div>
                </div>
              </div>
            ]]></add>
        </operation>
    </file>

    <!-- 5. DESIGN TEMPLATE (Admin-panel) -->

    <file path="admin/view/template/design/layout_form.tpl">
        <operation>
            <search><![CDATA[
            <table id="module-content-bottom" class="table table-striped table-bordered table-hover">
            ]]></search>
            <add position="before"><![CDATA[
                <table id="module-content-middle" class="table table-striped table-bordered table-hover">
                  <thead>
                  <tr>
                    <td class="text-center"><?php echo $text_content_middle; ?></td>
                  </tr>
                  </thead>
                  <tbody>
                  <?php foreach ($layout_modules as $layout_module) { ?>
                  <?php if ($layout_module['position'] == 'content_middle') { ?>
                  <tr id="module-row<?php echo $module_row; ?>">
                    <td class="text-left"><div class="input-group">
                        <select name="layout_module[<?php echo $module_row; ?>][code]" class="form-control input-sm">
                          <?php foreach ($extensions as $extension) { ?>
                          <optgroup label="<?php echo $extension['name']; ?>">
                            <?php if (!$extension['module']) { ?>
                            <?php if ($extension['code'] == $layout_module['code']) { ?>
                            <option value="<?php echo $extension['code']; ?>" selected="selected"><?php echo $extension['name']; ?></option>
                            <?php } else { ?>
                            <option value="<?php echo $extension['code']; ?>"><?php echo $extension['name']; ?></option>
                            <?php } ?>
                            <?php } else { ?>
                            <?php foreach ($extension['module'] as $module) { ?>
                            <?php if ($module['code'] == $layout_module['code']) { ?>
                            <option value="<?php echo $module['code']; ?>" selected="selected"><?php echo $module['name']; ?></option>
                            <?php } else { ?>
                            <option value="<?php echo $module['code']; ?>"><?php echo $module['name']; ?></option>
                            <?php } ?>
                            <?php } ?>
                            <?php } ?>
                          </optgroup>
                          <?php } ?>
                        </select>
                        <input type="hidden" name="layout_module[<?php echo $module_row; ?>][position]" value="<?php echo $layout_module['position']; ?>" />
                        <input type="hidden" name="layout_module[<?php echo $module_row; ?>][sort_order]" value="<?php echo $layout_module['sort_order']; ?>" />
                        <div class="input-group-btn"><a href="<?php echo $layout_module['edit']; ?>" type="button" data-toggle="tooltip" title="<?php echo $button_edit; ?>" target="_blank" class="btn btn-primary btn-sm"><i class="fa fa-pencil"></i></a>
                          <button type="button" onclick="$('#module-row<?php echo $module_row; ?>').remove();" data-toggle="tooltip" title="<?php echo $button_remove; ?>" class="btn btn-danger btn-sm"><i class="fa fa fa-minus-circle"></i></button>
                        </div>
                      </div></td>
                  </tr>
                  <?php $module_row++; ?>
                  <?php } ?>
                  <?php } ?>
                  </tbody>
                  <tfoot>
                  <tr>
                    <td class="text-left"><div class="input-group">
                        <select class="form-control input-sm">
                          <?php foreach ($extensions as $extension) { ?>
                          <optgroup label="<?php echo $extension['name']; ?>">
                            <?php if (!$extension['module']) { ?>
                            <option value="<?php echo $extension['code']; ?>"><?php echo $extension['name']; ?></option>
                            <?php } else { ?>
                            <?php foreach ($extension['module'] as $module) { ?>
                            <option value="<?php echo $module['code']; ?>"><?php echo $module['name']; ?></option>
                            <?php } ?>
                            <?php } ?>
                          </optgroup>
                          <?php } ?>
                        </select>
                        <div class="input-group-btn">
                          <button type="button" onclick="addModule('content-middle');" data-toggle="tooltip" title="<?php echo $button_module_add; ?>" class="btn btn-primary btn-sm"><i class="fa fa-plus-circle"></i></button>
                        </div>
                      </div></td>
                  </tr>
                  </tfoot>
                </table>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $('#module-column-left, #module-column-right, #module-content-top, #module-content-bottom').delegate('select[name*=\'code\']', 'change', function() {
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
$('#module-column-left, #module-column-right, #module-content-top, #module-content-bottom, #module-content-middle').delegate('select[name*=\'code\']', 'change', function() {
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[
            $('#module-column-left, #module-column-right, #module-content-top, #module-content-bottom').trigger('change');
            ]]></search>
            <add position="replace" trim="true"><![CDATA[
$('#module-column-left, #module-column-right, #module-content-top, #module-content-bottom, #module-content-middle').trigger('change');
            ]]></add>
        </operation>
    </file>

    <!-- *** //END TEMPLATE (Admin-panel)// *** -->

    <!-- ======================================= //END ADMIN-PANEL// ======================================= -->

</modification>